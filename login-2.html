<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Login Solutions - Login</title>
        <link rel="stylesheet" href="login-2.css">
    </head>
    <body>
        <div class="bigbox">
            <div class="logbox">
                <h2>Sign In</h2>
                <form id="logcollect" onsubmit="userlogin(event)">
                    <div class="textbox">
                        <input type="text" id="username" name="username" required placeholder=" ">
                        <label for="username">Username</label>
                    </div>
                    <div class="textbox">
                        <input type="password" id="password" name="password" required placeholder=" ">
                        <label for="password">Password</label>
                    </div>
                    <button type="submit">Ready to login?</button>
                </form>
                <div id="result" class="hidden"></div>
                <div class="register">
                    Did you forget to register? <a href="register-2.html">Try going here first!</a>
                </div>
            </div>
        </div>

        <script>
            async function userlogin(event) {
                event.preventDefault();

                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const result = document.getElementById('result');

                try {
                    const response = await fetch('https://login-data-04911d02a754.herokuapp.com/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ username, password })
                    });

                    if (response.ok) {
                        result.classList.add('success');
                        result.textContent = "We're in! Redirecting...";
                        result.classList.remove('hidden');
                        setTimeout(() => {
                            window.location.href = 'portal-2.html';
                        }, 500);
                    } else {
                        const errordata = await response.json();
                        result.classList.add('error');
                        result.textContent = errordata.message || "Oh no! Check your details and try again!";
                        result.classList.remove('hidden');
                    }
                } catch (error) {
                    
                }
            }
        </script>
    </body>
</html>